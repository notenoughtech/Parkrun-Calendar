function createParkrunAndInvite() {

  //this script creates a fixed event "Parkrun" and invites the guests from the list

// PARAMETERS
 
  const calendarId = SECRET.calendarId;               // See Secrets.gs for details  
  const inviteEmails = SECRET.parkrunEmails;          // See Secrets.gs for details   
  const eventTitle = "Parkrun";                       // Event title 
  


//This is a fixed Parkrun event, script runs on Sunday (a day after the event and creates one ahead of time)
// Next Saturday 9:00 - 10:30
  const now = new Date();
  const dayOfWeek = now.getDay();
  const daysUntilSaturday = (6 - dayOfWeek + 7) % 7 || 7;
  const eventStart = new Date(now);
  eventStart.setDate(now.getDate() + daysUntilSaturday);
  eventStart.setHours(9, 0, 0, 0);
  const eventEnd = new Date(eventStart);
  eventEnd.setHours(10, 30, 0, 0);

  const calendar = CalendarApp.getCalendarById(calendarId);
  if (!calendar) {
    Logger.log(`Calendar with ID "${calendarId}" not found.`);
    return;
  }

// Step 1: Create event WITHOUT guests
  const event = calendar.createEvent(eventTitle, eventStart, eventEnd, {
    guestsCanSeeGuests: false
  });
  Logger.log(`Created event "${eventTitle}" on ${eventStart}`);

// Step 2: Add guests one by one so I can enforce the event settings so they don't see others (keeps the emails private among guests)
  inviteEmails.forEach(email => {
    try {
      event.addGuest(email);
      Logger.log(`Added guest ${email}`);
    } catch (e) {
      Logger.log(`Failed to add guest ${email}: ${e}`);
    }
  });

  Logger.log(`All guests invited to "${eventTitle}" (guests cannot see each other)`);
}
